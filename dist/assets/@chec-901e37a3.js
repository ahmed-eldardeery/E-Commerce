import{o as objectWithoutPropertiesExports,t as toConsumableArrayExports,_ as _typeofExports,d as definePropertyExports,c as classCallCheckExports,a as createClassExports,r as regenerator,b as asyncToGeneratorExports}from"./@babel-c5a05878.js";import{a as axiosExports}from"./axios-419cf3fb.js";var _objectWithoutProperties=objectWithoutPropertiesExports,_toConsumableArray=toConsumableArrayExports,_typeof=_typeofExports,_defineProperty=definePropertyExports,_classCallCheck=classCallCheckExports,_createClass=createClassExports,_regeneratorRuntime=regenerator,_asyncToGenerator=asyncToGeneratorExports,axios=axiosExports;function _interopDefaultLegacy(r){return r&&typeof r=="object"&&"default"in r?r:{default:r}}var _objectWithoutProperties__default=_interopDefaultLegacy(_objectWithoutProperties),_toConsumableArray__default=_interopDefaultLegacy(_toConsumableArray),_typeof__default=_interopDefaultLegacy(_typeof),_defineProperty__default=_interopDefaultLegacy(_defineProperty),_classCallCheck__default=_interopDefaultLegacy(_classCallCheck),_createClass__default=_interopDefaultLegacy(_createClass),_regeneratorRuntime__default=_interopDefaultLegacy(_regeneratorRuntime),_asyncToGenerator__default=_interopDefaultLegacy(_asyncToGenerator),axios__default=_interopDefaultLegacy(axios),Storage=function(){function r(e){_classCallCheck__default.default(this,r),this.commerce=e}return _createClass__default.default(r,[{key:"set",value:function(e,t,n){if(typeof document>"u"||this.commerce.options.disableStorage)return null;var o,a="";if(o=this.commerce.options.config&&this.commerce.options.config.cookie_path!==void 0?this.commerce.options.config.cookie_path:"/",n){var c=new Date;c.setTime(c.getTime()+24*n*60*60*1e3),a="; expires="+c.toUTCString()}return document.cookie=e+"="+t+a+"; path="+o}},{key:"get",value:function(e){if(typeof document>"u"||this.commerce.options.disableStorage)return null;e+="=";for(var t=0,n=Array.from(document.cookie.split(";"));t<n.length;t++){for(var o=n[t];o.charAt(0)===" ";)o=o.substring(1,o.length);if(o.indexOf(e)===0)return o.substring(e.length,o.length)}return null}},{key:"remove",value:function(e){return this.set(e,"",-1)}}]),r}();function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(t,!0).forEach(function(n){_defineProperty__default.default(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(t).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var Cart=function(){function r(t){_classCallCheck__default.default(this,r),this.commerce=t,this.cartId=null}var e;return _createClass__default.default(r,[{key:"refresh",value:function(){var t=this;return this.commerce.request("carts").then(function(n){var o=n.id;return t.commerce.storage.set("commercejs_cart_id",o,t.commerce.options.cartLifetime),t.cartId=o,n})}},{key:"id",value:function(){if(this.cartId!==null)return this.cartId;var t=this.commerce.storage.get("commercejs_cart_id");return typeof t=="string"&&t.length?t:null}},{key:"request",value:(e=_asyncToGenerator__default.default(_regeneratorRuntime__default.default.mark(function t(){var n,o,a,c,i,l=this,s=arguments;return _regeneratorRuntime__default.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(n=s.length>0&&s[0]!==void 0?s[0]:"",o=s.length>1&&s[1]!==void 0?s[1]:"get",a=s.length>2&&s[2]!==void 0?s[2]:null,c=s.length>3&&s[3]!==void 0&&s[3],i=typeof n=="string"&&n.length?"/".concat(n):"",this.id()){m.next=8;break}return m.next=8,this.refresh();case 8:return m.abrupt("return",this.commerce.request("carts/".concat(this.id()).concat(i),o,a,c).catch(function(h){if(h.statusCode&&h.statusCode===404)return l.refresh().then(function(){return l.commerce.request("carts/".concat(l.id()).concat(i),o,a,c)});throw h}));case 9:case"end":return m.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"add",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a={};if(typeof o=="string"&&o.startsWith("vrnt"))a.variant_id=o;else if(o&&_typeof__default.default(o)==="object"){var c=Object.keys(o).every(function(s){return s.startsWith("vgrp")}),i=Object.values(o).every(function(s){return s.startsWith("optn")});if(!c||!i)throw new Error("The variant options provided to cart.add do not appear to be a valid map of group IDs to option IDs");a.options=o}else if(o)throw new Error("Variant data provided to cart.add must be a variant ID, or a map of group IDs to option IDs");var l=_objectSpread({id:_typeof__default.default(t)==="object"?t.id:t,quantity:n},a);return this.request("","post",l)}},{key:"retrieve",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return n&&(this.cartId=n),this.request().then(function(o){return t.cartId=o&&o.id||null,o})}},{key:"checkQuantity",value:function(t,n){return this.commerce.request("products/".concat(t)).then(function(o){return n<=o.quantity})}},{key:"remove",value:function(t){return this.request("items/".concat(t),"delete")}},{key:"delete",value:function(){return this.request("","delete")}},{key:"update",value:function(t,n){return this.request("items/".concat(t),"put",n)}},{key:"contents",value:function(){return this.request("items")}},{key:"empty",value:function(){return this.request("items","delete")}}]),r}(),Categories=function(){function r(e){_classCallCheck__default.default(this,r),this.commerce=e}return _createClass__default.default(r,[{key:"list",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return typeof e=="function"?this.commerce.request("categories"):this.commerce.request("categories","get",e)}},{key:"retrieve",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.commerce.request("categories/".concat(e),"get",t)}}]),r}(),Checkout=function(){function Checkout(r){_classCallCheck__default.default(this,Checkout),this.commerce=r}return _createClass__default.default(Checkout,[{key:"protect",value:function protect(token){return this.commerce.request("checkouts/".concat(token,"/protect")).then(function(data){return eval(data.sift_js)})}},{key:"generateToken",value:function(r,e){return this.commerce.request("checkouts/".concat(r),"get",e)}},{key:"generateTokenFrom",value:function(r,e){if(!["product_id","cart","permalink"].includes(r))throw new Error('Cannot generate a token with unknown "'.concat(r,'" type'));return this.generateToken(e,{type:r})}},{key:"capture",value:function(r,e){var t=this;return this.commerce.request("checkouts/".concat(r),"post",e).then(function(n){return t.commerce.cart.refresh(),n})}},{key:"receipt",value:function(r){return this.commerce.request("checkouts/".concat(r,"/receipt"))}},{key:"checkPayWhatYouWant",value:function(r,e){return this.commerce.request("checkouts/".concat(r,"/check/pay_what_you_want"),"get",e)}},{key:"fields",value:function(r){return this.commerce.request("checkouts/".concat(r,"/fields"))}},{key:"setTaxZone",value:function(r,e){return this.commerce.request("checkouts/".concat(r,"/helper/set_tax_zone"),"get",e)}},{key:"getLocationFromIP",value:function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t=e&&e.length?"?ip_address=".concat(e):"";return this.commerce.request("checkouts/".concat(r,"/helper/location_from_ip").concat(t))}},{key:"isFree",value:function(r){return this.commerce.request("checkouts/".concat(r,"/check/is_free"))}},{key:"checkVariant",value:function(r,e,t){return this.commerce.request("checkouts/".concat(r,"/check/").concat(e,"/variant"),"get",t)}},{key:"checkDiscount",value:function(r,e){return this.commerce.request("checkouts/".concat(r,"/check/discount"),"get",e)}},{key:"checkShippingOption",value:function(r,e){return this.commerce.request("checkouts/".concat(r,"/check/shipping"),"get",e)}},{key:"getShippingOptions",value:function(r,e){return this.commerce.request("checkouts/".concat(r,"/helper/shipping_options"),"get",e)}},{key:"checkQuantity",value:function(r,e,t){return this.commerce.request("checkouts/".concat(r,"/check/").concat(e,"/quantity"),"get",t)}},{key:"helperValidation",value:function(r){return this.commerce.request("checkouts/".concat(r,"/helper/validation"))}},{key:"getLive",value:function(r){return this.commerce.request("checkouts/".concat(r,"/live"))}},{key:"getToken",value:function(r){return this.commerce.request("checkouts/tokens/".concat(r))}},{key:"checkGiftcard",value:function(r,e){return this.commerce.request("checkouts/".concat(r,"/check/giftcard"),"get",e)}}]),Checkout}();function ownKeys$1(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),t.push.apply(t,n)}return t}function _objectSpread$1(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ownKeys$1(t,!0).forEach(function(n){_defineProperty__default.default(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys$1(t).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var Customer=function(){function r(e){_classCallCheck__default.default(this,r),this.commerce=e,this.data={}}return _createClass__default.default(r,[{key:"login",value:function(e,t){return this.commerce.request("customers/email-token","post",{email:e,base_url:t})}},{key:"getToken",value:function(e){var t=this,n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return this.commerce.request("customers/exchange-token","post",{token:e}).then(function(o){return n&&(o.customer_id||o.jwt)&&(t.data={id:o.customer_id||null,token:o.jwt||null},window.localStorage.setItem("commercejs_customer_id",t.data.id),window.localStorage.setItem("commercejs_customer_token",t.data.token)),o})}},{key:"update",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this._assertArgsProvided(t,n),this._request("customers/".concat(t||this.id()),"PUT",e,{},n)}},{key:"getOrders",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this._assertArgsProvided(e,t);var o=_objectSpread$1({sortBy:"created_at",sortDirection:"desc"},n);return this._request("customers/".concat(e||this.id(),"/orders"),"get",o,{},t)}},{key:"getOrder",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this._assertArgsProvided(t,n),this._request("customers/".concat(t||this.id(),"/orders/").concat(e),"get",{},{},n)}},{key:"about",value:function(){return this._request("customers/".concat(this.id()))}},{key:"id",value:function(){return this._fromStorage("id")}},{key:"token",value:function(){return this._fromStorage("token")}},{key:"isLoggedIn",value:function(){return this.id()!==null&&this.token()!==null}},{key:"logout",value:function(){this.data={},window.localStorage.removeItem("commercejs_customer_id"),window.localStorage.removeItem("commercejs_customer_token")}},{key:"_fromStorage",value:function(e){if(this.data[e]&&this.data[e].length)return this.data[e];var t=window.localStorage.getItem("commercejs_customer_".concat(e));return typeof t=="string"&&t.length?t:null}},{key:"_request",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"get",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,c=a||this.token();return this.commerce.request(e,t,n,_objectSpread$1({"X-Authorization":void 0,Authorization:"Bearer ".concat(c)},o))}},{key:"_assertArgsProvided",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(e===null&&!this.id())throw new Error("A customer ID must be provided when customer is not logged in");if(t===null&&!this.token())throw new Error("A customer access token must be provided when customer is not logged in")}}]),r}(),Merchants=function(){function r(e){_classCallCheck__default.default(this,r),this.commerce=e}return _createClass__default.default(r,[{key:"about",value:function(){return this.commerce.request("merchants")}}]),r}(),Products=function(){function r(e){_classCallCheck__default.default(this,r),this.commerce=e}return _createClass__default.default(r,[{key:"list",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.commerce.request("products","get",e)}},{key:"retrieve",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.commerce.request("products/".concat(e),"get",t)}},{key:"getVariants",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.commerce.request("products/".concat(e,"/variants"),"get",t)}},{key:"getVariant",value:function(e,t){return this.commerce.request("products/".concat(e,"/variants/").concat(t),"get")}}]),r}(),Services=function(){function r(e){_classCallCheck__default.default(this,r),this.commerce=e}return _createClass__default.default(r,[{key:"localeListCountries",value:function(){return this.commerce.request("services/locale/countries")}},{key:"localeListShippingCountries",value:function(e){return this.commerce.request("services/locale/".concat(e,"/countries"))}},{key:"localeListShippingSubdivisions",value:function(e,t){return this.commerce.request("services/locale/".concat(e,"/countries/").concat(t,"/subdivisions"))}},{key:"localeListSubdivisions",value:function(e){return this.commerce.request("services/locale/".concat(e,"/subdivisions"))}}]),r}(),Features={Cart,Categories,Checkout,Customer,Merchants,Products,Services},consoleHelper=function(){var r,e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"black",n=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,c=!1;switch(t){case"success":t="#488f5a",r="✅   ";break;case"info":t="DodgerBlue",r="";break;case"error":t="rgba(244, 67, 54, 1)",a.error.type==="validation"||a.error.type==="unprocessable_entity"?(r="🚫 Validation/missing fields",n=""):r="❌ HTTP ERROR ",c=!0;break;case"warning":t="rgba(208, 154, 35, 1)",r="⚠️  "}return c===!0?(console.log("%c"+r+n,"color:"+t+";display:block; width: 100%;padding:2px 2px 2px 0px;font-family: Open Sans, Helvetica, Sans-serif;font-weight:bold;background-color:rgba(244, 67, 54, 0.15);"),_typeof__default.default(a.error.errors)==="object"?(e=a.error.errors,void Object.keys(e).forEach(function(i,l){Object.values(e[i]).forEach(function(s){console.log("%c"+i+": %c"+s,"color:#515D6D;font-family: Open Sans, Helvetica, Sans-serif;font-weight:800;","color:#515D6D;font-family: Open Sans, Helvetica, Sans-serif;font-weight:400;")})})):console.log("%c"+a.error.message,"color:#515D6D;font-family: Open Sans, Helvetica, Sans-serif;font-weight:400;")):_typeof__default.default(t)==="object"?(console.log("%c"+n,"color: PowderBlue;font-weight:bold;font-family: Open Sans, Helvetica, Sans-serif; background-color: RoyalBlue;"),void console.log(t)):(console.log("%c"+r+n,"color:"+t+";display:block;font-family: Open Sans, Helvetica, Sans-serif;line-height:28px; width: 100%;padding:2px 2px 2px 0px;font-weight:bold;"),void(o&&console.log("%c"+o,"color:#515D6D;line-height:22px;font-weight:400; font-family: Open Sans, Helvetica, Sans-serif;")))},debuggerOnNotice=function(){typeof window<"u"&&(console.log(`%c\r
 \r
                           Che         EcC\r
                         c....c2    2c....:C\r
                       c........c2   2c.....:C\r
                     c............c2   2c.....:C\r
                   c................c2   2c.....:C\r
                 c....................c2   2c.....:C\r
               c........................c2   2c.....:C\r
             c............................c2   2c.....:C\r
           c.......:E2  2c..................c2   2c.....:C\r
         c........h  $$   2c..................c2   2c.....:C\r
       c.........:C  $cc$  E....................c2   2c.....:C\r
     c............h    $$  c......................c2   2c.....:C\r
   c...............:E    E:.........................c2   2c.....:C\r
   E............................:C c..................h2   2c...:C\r
     E........................:C     c..................h2   2hC\r
       E....................:C         c..................h2\r
         E................:C             c................:C\r
           E............:C                 c............:C\r
             E........:C                     c........:C\r
               E....:C                         c....:C\r
                 EcC                             EcC\r
 \r
 \r
 \r
`,"font-family: Courier New, Courier, monospace; color: #788ba4; font-weight:bold; font-size: 11px;"),console.log("%cCommerce.js console debugger is on!  🎉","text-align:center; display:block; font-family: Open Sans, Helvetica, Sans-serif; color: #488f5a; line-height:28px; font-size: 14px"),console.log(`%c💬   Need some help? Join our Slack channel - http://slack.commercejs.com \r
`,"text-align:center; display:block; font-family: Open Sans, Helvetica, Sans-serif; color: #515D6D; line-height:20px; font-size: 12px"))};function ownKeys$2(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),t.push.apply(t,n)}return t}function _objectSpread$2(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ownKeys$2(t,!0).forEach(function(n){_defineProperty__default.default(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys$2(t).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var defaultEventCallback=function(r){var e=new CustomEvent("Commercejs.".concat(r),{bubbles:!1,cancelable:!1});return window.dispatchEvent(e)},Commerce=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(_classCallCheck__default.default(this,r),this.options=_objectSpread$2(_objectSpread$2({version:"v1",url:"https://api.chec.io/",eventCallback:defaultEventCallback,disableStorage:!1,cartLifetime:30,allowSecretKey:!1},n),{},{apiKey:e,debug:t}),typeof e!="string"||e.length===0)throw new Error("⚠️ Invalid public key given to Commerce.js client");if(!n.allowSecretKey&&e.toLowerCase().substring(0,3)==="sk_")throw new Error("Secret key provided. You must use a public key with Commerce.js, or use `allowSecretKey` in the config object.");if(this.options.cartLifetime<=0||this.options.cartLifetime>30)throw new Error("cartLifetime configuration option must be between 1 and 30 days");this.storage=new Storage(this),this.cart=new Features.Cart(this),this.checkout=new Features.Checkout(this),this.customer=new Features.Customer(this),this.products=new Features.Products(this),this.services=new Features.Services(this),this.categories=new Features.Categories(this),this.merchants=new Features.Merchants(this),t&&(this.consoleHelper=consoleHelper,debuggerOnNotice())}return _createClass__default.default(r,[{key:"error",value:function(e){if(this.consoleHelper&&this.options.debug){var t=e.response,n="[".concat(t.status,"] Type: ").concat(t.statusText),o=typeof t.data=="string"?t.data:t.statusText;return this.consoleHelper("error",n,o,t.data)}}},{key:"request",value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"get",o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},c=arguments.length>4&&arguments[4]!==void 0&&arguments[4],i={"X-Authorization":this.options.apiKey,"X-Chec-Agent":"commerce.js/v2","Content-Type":"application/json"},l=n==="get"?o:null,s=n==="get"?null:o,m=this.options.timeoutMs||6e4,h=this.options.axiosConfig||{},f=this.options.url;f.substring(f.length-1)!=="/"&&(f+="/");var d=axios__default.default(_objectSpread$2(_objectSpread$2({url:e,method:n,baseURL:"".concat(f).concat(this.options.version,"/"),params:l,data:s,timeout:m},h),{},{headers:_objectSpread$2(_objectSpread$2(_objectSpread$2({},i),h.headers),a)}));if(c)return d;var g=this.options.eventCallback;return d.then(function(u){if(t.consoleHelper&&t.options.debug&&_typeof__default.default(u.data._console)==="object"&&t.consoleHelper.apply(t,_toConsumableArray__default.default(u.data._console)),_typeof__default.default(u.data)!=="object"||Array.isArray(u.data))return u.data;var p=u.data,v=p._event,_=_objectWithoutProperties__default.default(p,["_event"]);return typeof v=="string"&&typeof g=="function"&&g(v),_}).catch(function(u){throw t.error(u),u.response?{message:"Unsuccessful response (".concat(u.response.status,": ").concat(u.response.statusText,") received"),statusCode:u.response.status,statusText:u.response.statusText,data:u.response.data,originalError:u}:u})}}]),r}(),lib=Commerce;export{lib as l};
//# sourceMappingURL=@chec-901e37a3.js.map
