{"version":3,"file":"PaymentFrom-e4b72680.js","sources":["../../src/components/CheckoutForm/PaymentFrom.jsx"],"sourcesContent":["import React from \"react\";\nimport { Typography, Button, Divider } from \"@mui/material\";\nimport {\n  Elements,\n  CardElement,\n  ElementsConsumer\n} from \"@stripe/react-stripe-js\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { setError } from \"../../store/MainSlice\";\nconst Review= React.lazy(() => import(\"./Review\"))\nconst stripePromise = loadStripe(import.meta.env.VITE_STRIPE_PUBLIC_KEY);\n\nconst PaymentFrom = ({\n  shippingData,\n  checkoutToken,\n  nextStep,\n  backStep,\n  handleCaptureCheckout,\n  timeout\n}) => {\n  const handleSubmit = async (event, elements, stripe) => {\n    event.preventDefault();\n    if (!stripe || !elements) return;\n    const { error, paymentMethod } = await stripe.createPaymentMethod({\n      type: \"card\",\n      card: elements.getElement(CardElement)\n    });\n    if (error) {\n      Dispatch(setError(error));\n    } else {\n      const orderData = {\n        line_items: checkoutToken.line_items,\n        customer: {\n          firstname: shippingData.firstName,\n          lastname: shippingData.lastName,\n          email: shippingData.email\n        },\n        shipping: {\n          name: \"International\",\n          street: shippingData.address1,\n          town_city: shippingData.city,\n          county_state: shippingData.shippingSubdivision,\n          postal_zip_code: shippingData.zip,\n          country: shippingData.shippingCountry\n        },\n        fulfillment: { shipping_method: shippingData.shippingOption },\n        payment: {\n          gateway: \"stripe\",\n          stripe: {\n            payment_method_id: paymentMethod.id\n          }\n        }\n      };\n      handleCaptureCheckout(checkoutToken.id, orderData);\n      timeout();\n      nextStep();\n    }\n  };\n  return (\n    <>\n      <Review checkoutToken={checkoutToken} />\n      <Divider />\n      <Typography variant=\"h6\" gutterBottom style={{ margin: \"20px 0\" }}>\n        Payment method\n      </Typography>\n      <Elements stripe={stripePromise}>\n        <ElementsConsumer>\n          {({ elements, stripe }) => {\n            return (\n              <form onSubmit={(e) => handleSubmit(e, elements, stripe)}>\n                <CardElement />\n                <br /> <br />\n                <div\n                  style={{ display: \"flex\", justifyContent: \"space-between\" }}\n                >\n                  <Button\n                    variant=\"outlined\"\n                   \n                    onClick={backStep}\n                  >\n                    Back\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    variant=\"contained\"\n                    disabled={!stripe}\n                   \n                  >\n                    Pay {checkoutToken.subtotal.formatted_with_symbol}\n                  </Button>\n                </div>\n              </form>\n            );\n          }}\n        </ElementsConsumer>\n      </Elements>\n    </>\n  );\n};\n\nexport default PaymentFrom;\n"],"names":["Review","React","__vitePreload","stripePromise","loadStripe","PaymentFrom","shippingData","checkoutToken","nextStep","backStep","handleCaptureCheckout","timeout","handleSubmit","event","elements","stripe","error","paymentMethod","CardElement","setError","orderData","jsxs","Fragment","jsx","Divider","Typography","Elements","ElementsConsumer","e","Button"],"mappings":"25BASA,MAAMA,EAAQC,EAAM,KAAK,IAAMC,EAAA,IAAA,OAAO,sBAAU,EAAC,kBAAA,CAAA,EAC3CC,EAAgBC,EAAW,6GAAsC,EAEjEC,EAAc,CAAC,CACnB,aAAAC,EACA,cAAAC,EACA,SAAAC,EACA,SAAAC,EACA,sBAAAC,EACA,QAAAC,CACF,IAAM,CACJ,MAAMC,EAAe,MAAOC,EAAOC,EAAUC,IAAW,CAElD,GADJF,EAAM,eAAe,EACjB,CAACE,GAAU,CAACD,EAAU,OAC1B,KAAM,CAAE,MAAAE,EAAO,cAAAC,CAAkB,EAAA,MAAMF,EAAO,oBAAoB,CAChE,KAAM,OACN,KAAMD,EAAS,WAAWI,CAAW,CAAA,CACtC,EACD,GAAIF,EACO,SAAAG,EAASH,CAAK,CAAC,MACnB,CACL,MAAMI,EAAY,CAChB,WAAYb,EAAc,WAC1B,SAAU,CACR,UAAWD,EAAa,UACxB,SAAUA,EAAa,SACvB,MAAOA,EAAa,KACtB,EACA,SAAU,CACR,KAAM,gBACN,OAAQA,EAAa,SACrB,UAAWA,EAAa,KACxB,aAAcA,EAAa,oBAC3B,gBAAiBA,EAAa,IAC9B,QAASA,EAAa,eACxB,EACA,YAAa,CAAE,gBAAiBA,EAAa,cAAe,EAC5D,QAAS,CACP,QAAS,SACT,OAAQ,CACN,kBAAmBW,EAAc,EACnC,CACF,CAAA,EAEoBP,EAAAH,EAAc,GAAIa,CAAS,EACzCT,IACCH,IACX,EAEF,OAEIa,EAAAC,EAAA,CAAA,SAAA,CAAAC,EAACvB,GAAO,cAAAO,EAA8B,IACrCiB,EAAQ,EAAA,EACTD,EAACE,EAAW,CAAA,QAAQ,KAAK,aAAY,GAAC,MAAO,CAAE,OAAQ,QAAS,EAAG,SAEnE,gBAAA,CAAA,EACAF,EAACG,EAAS,CAAA,OAAQvB,EAChB,SAAAoB,EAACI,GACE,SAAC,CAAA,CAAE,SAAAb,EAAU,OAAAC,CAAA,IAEVM,EAAC,QAAK,SAAWO,GAAMhB,EAAagB,EAAGd,EAAUC,CAAM,EACrD,SAAA,CAAAQ,EAACL,EAAY,EAAA,IACZ,KAAG,EAAA,EAAE,MAAE,KAAG,EAAA,EACXG,EAAC,MAAA,CACC,MAAO,CAAE,QAAS,OAAQ,eAAgB,eAAgB,EAE1D,SAAA,CAAAE,EAACM,EAAA,CACC,QAAQ,WAER,QAASpB,EACV,SAAA,MAAA,CAED,EACAY,EAACQ,EAAA,CACC,KAAK,SACL,QAAQ,YACR,SAAU,CAACd,EAEZ,SAAA,CAAA,OACMR,EAAc,SAAS,qBAAA,CAAA,CAC9B,CAAA,CAAA,CACF,CACF,CAAA,CAAA,EAGN,CACF,CAAA,CACF,CAAA,CAAA,CAEJ"}