{"version":3,"file":"Checkout-5e847c8f.js","sources":["../../src/components/CheckoutForm/Checkout/Checkout.jsx"],"sourcesContent":["import React, { useState, useEffect, Suspense, lazy } from \"react\";\nimport {\n  Paper,\n  Stepper,\n  Step,\n  StepLabel,\n  Typography,\n  Button,\n  CssBaseline,\n  Toolbar\n} from \"@mui/material\";\nimport { useSelector } from \"react-redux\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport commerce from \"../../../lib/commerce\";\nimport Loading from \"../../Loading\";\nimport { styled } from '@mui/material/styles';\nconst AddressForm = lazy(() => import(\"../AddressForm\"));\nconst PaymentFrom = lazy(() => import(\"../PaymentFrom\"));\n\nconst steps = [\"Shipping address\", \"Payment details\"];\nconst MainLayout = styled(\"main\")(({ theme }) => ({\n  marginTop: \"5%\",\n  width: \"auto\",\n  marginLeft: theme.spacing(2),\n  marginRight: theme.spacing(2),\n\n  [theme.breakpoints.up(600)]: {\n    width: 600,\n    marginLeft: \"auto\",\n    marginRight: \"auto\",\n  },\n}));\n\nconst StyledPaper = styled(Paper)(({ theme }) => ({\n  marginTop: theme.spacing(3),\n  marginBottom: theme.spacing(3),\n  padding: theme.spacing(2),\n\n  [theme.breakpoints.down(\"xs\")]: {\n    width: \"100%\",\n    marginTop: 60,\n  },\n\n  [theme.breakpoints.up(600 + theme.spacing(3) * 2)]: {\n    marginTop: theme.spacing(6),\n    marginBottom: theme.spacing(6),\n    padding: theme.spacing(3),\n  },\n}));\n\nconst StyledStepper = styled(Stepper)(({ theme }) => ({\n  padding: theme.spacing(3, 0, 5),\n}));\nconst Checkout = ({ handleCaptureCheckout }) => {\n  const [activeStep, setActiveStep] = useState(0);\n  const [checkoutToken, setCheckoutToken] = useState(null);\n  const [shippingData, setShippingData] = useState({});\n  const [isFinished, setIsFinished] = useState(false);\n  const navigate = useNavigate();\n  const { cartData, isLoading, error, Order } = useSelector(\n    (state) => state.MainSlice\n  );\n\n  if (isLoading) {\n    return <Loading />;\n  }\n  useEffect(() => {\n    const generateToken = async () => {\n      try {\n        const token = await commerce.checkout.generateToken(cartData.id, {\n          type: \"cart\"\n        });\n        setCheckoutToken(token);\n      } catch (error) {\n        console.log(error);\n        navigate(\"/E-Commerce/\");\n      }\n    };\n    if (cartData.id && cartData.line_items.length > 0) {\n      generateToken();\n    }\n  }, [cartData]);\n\n  const nextStep = () => setActiveStep((prevActiveStep) => prevActiveStep + 1);\n  const backStep = () => setActiveStep((prevActiveStep) => prevActiveStep - 1);\n\n  const next = (data) => {\n    setShippingData(data);\n    nextStep();\n  };\n  const timeout = () => {\n    return setTimeout(() => {\n      setIsFinished(true);\n    }, 10000);\n  };\n  const Form = () =>\n    activeStep == 0 ? (\n      <AddressForm checkoutToken={checkoutToken} next={next} />\n    ) : (\n      <PaymentFrom\n        shippingData={shippingData}\n        checkoutToken={checkoutToken}\n        nextStep={nextStep}\n        backStep={backStep}\n        handleCaptureCheckout={handleCaptureCheckout}\n        timeout={timeout}\n      />\n    );\n\n  let Confirmation = () => {\n    if (Order.customer) {\n      return (\n        <>\n          <div style={{ textDecoration: \"none\" }}>\n            <Typography variant=\"h5\">\n              Thank you for your purchase, {Order.customer.firstname}{\" \"}\n              {/* space between name*/}\n              {Order.customer.lastname}\n            </Typography>\n            <Typography variant=\"subtitle2\">\n              Order ref: {Order.customer_reference}\n            </Typography>\n          </div>\n          <br />\n          <Link\n            to=\"/E-Commerce/\"\n            \n            style={{ textDecoration: \"none\" }}\n          >\n            <Button variant=\"outlined\" type=\"button\">\n              Back to Home\n            </Button>\n          </Link>\n        </>\n      );\n    } else if (isFinished) {\n      return (\n        <>\n          <div>\n            <Typography variant=\"h5\">Thank you for your purchase</Typography>\n          </div>\n          <br />\n          <Link\n            to=\"/E-Commerce/\"\n            style={{ textDecoration: \"none\" }}\n            \n          >\n            <Button variant=\"outlined\" type=\"button\">\n              Back to Home\n            </Button>\n          </Link>\n        </>\n      );\n    } else {\n      return <Loading />;\n    }\n  };\n  if (error) {\n    Confirmation = () => (\n      <>\n        <Typography variant=\"h5\">Error: {error}</Typography>\n        <br />\n        <Link to=\"/E-Commerce/\" style={{ textDecoration: \"none\" }}>\n          <Button\n            variant=\"outlined\"\n            type=\"button\"\n            style={{ textDecoration: \"none\" }}\n          >\n            Back to home\n          </Button>\n        </Link>\n      </>\n    );\n  }\n  return (\n    <>\n    <Suspense fallback={<Loading />}>\n      <CssBaseline />\n      <Toolbar />\n      <MainLayout>\n        <StyledPaper>\n          <Typography variant=\"h4\" align=\"center\">\n            Checkout\n          </Typography>\n          <StyledStepper activeStep={activeStep}>\n            {steps.map((step) => {\n              return (\n                <Step key={step}>\n                  <StepLabel>{step}</StepLabel>\n                </Step>\n              );\n            })}\n          </StyledStepper>\n          {activeStep === steps.length ? (\n            <Confirmation />\n          ) : checkoutToken ? (\n            <Form />\n          ) : (\n            <Loading />\n          )}\n        </StyledPaper>\n      </MainLayout>\n    </Suspense>\n  </>\n  );\n};\n\nexport default Checkout;\n"],"names":["AddressForm","lazy","__vitePreload","PaymentFrom","steps","MainLayout","styled","theme","StyledPaper","Paper","StyledStepper","Stepper","Checkout","handleCaptureCheckout","activeStep","setActiveStep","useState","checkoutToken","setCheckoutToken","shippingData","setShippingData","isFinished","setIsFinished","navigate","useNavigate","cartData","isLoading","error","Order","useSelector","state","Loading","useEffect","generateToken","token","commerce","nextStep","prevActiveStep","backStep","next","data","timeout","Form","jsx","Confirmation","jsxs","Fragment","Typography","Link","Button","Suspense","CssBaseline","Toolbar","step","Step","StepLabel"],"mappings":"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"}