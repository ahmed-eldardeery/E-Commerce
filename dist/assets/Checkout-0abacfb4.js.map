{"version":3,"file":"Checkout-0abacfb4.js","sources":["../../src/components/CheckoutForm/Checkout/styles.js","../../src/components/CheckoutForm/Checkout/Checkout.jsx"],"sourcesContent":["import { makeStyles } from \"@mui/styles\";\r\nexport default makeStyles((theme) => ({\r\n  appBar: {\r\n    position: \"relative\"\r\n  },\r\n  toolbar: theme.mixins.toolbar,\r\n  layout: {\r\n    marginTop: \"5%\",\r\n    width: \"auto\",\r\n    marginLeft: theme.spacing(2),\r\n    marginRight: theme.spacing(2),\r\n    [theme.breakpoints.up(600)]: {\r\n      width: 600,\r\n      marginLeft: \"auto\",\r\n      marginRight: \"auto\"\r\n    }\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(3),\r\n    marginBottom: theme.spacing(3),\r\n    padding: theme.spacing(2),\r\n    [theme.breakpoints.down(\"xs\")]: {\r\n      width: \"100%\",\r\n      marginTop: 60\r\n    },\r\n    [theme.breakpoints.up(600 + theme.spacing(3) * 2)]: {\r\n      marginTop: theme.spacing(6),\r\n      marginBottom: theme.spacing(6),\r\n      padding: theme.spacing(3)\r\n    }\r\n  },\r\n  stepper: {\r\n    padding: theme.spacing(3, 0, 5)\r\n  },\r\n  buttons: {\r\n    display: \"flex\",\r\n    justifyContent: \"flex-end\"\r\n  },\r\n  button: {\r\n    marginTop: theme.spacing(3),\r\n    marginLeft: theme.spacing(1)\r\n  },\r\n  divider: {\r\n    margin: \"20px 0\"\r\n  },\r\n  spinner: {\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\"\r\n  }\r\n}));\r\n","import React, { useState, useEffect, Suspense, lazy } from \"react\";\r\nimport {\r\n  Paper,\r\n  Stepper,\r\n  Step,\r\n  StepLabel,\r\n  Typography,\r\n  Button,\r\n  CssBaseline\r\n} from \"@material-ui/core\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport commerce from \"../../../lib/commerce\";\r\nimport useStyles from \"./styles\";\r\nimport Loading from \"../../Loading\";\r\n// import AddressForm from \"../AddressForm\";\r\n// import PaymentFrom from \"../PaymentFrom\";\r\nconst AddressForm = lazy(() => import(\"../AddressForm\"));\r\nconst PaymentFrom = lazy(() => import(\"../PaymentFrom\"));\r\n\r\nconst steps = [\"Shipping address\", \"Payment details\"];\r\nconst Checkout = ({ handleCaptureCheckout }) => {\r\n  const classes = useStyles();\r\n  const [activeStep, setActiveStep] = useState(0);\r\n  const [checkoutToken, setCheckoutToken] = useState(null);\r\n  const [shippingData, setShippingData] = useState({});\r\n  const [isFinished, setIsFinished] = useState(false);\r\n  const navigate = useNavigate();\r\n  const { cartData, isLoading, error, Order } = useSelector(\r\n    (state) => state.MainSlice\r\n  );\r\n\r\n  if (isLoading) {\r\n    return <Loading />;\r\n  }\r\n  useEffect(() => {\r\n    const generateToken = async () => {\r\n      try {\r\n        const token = await commerce.checkout.generateToken(cartData.id, {\r\n          type: \"cart\"\r\n        });\r\n        setCheckoutToken(token);\r\n      } catch (error) {\r\n        console.log(error);\r\n        navigate(\"/E-Commerce/\");\r\n      }\r\n    };\r\n    if (cartData.id && cartData.line_items.length > 0) {\r\n      generateToken();\r\n    }\r\n  }, [cartData]);\r\n\r\n  const nextStep = () => setActiveStep((prevActiveStep) => prevActiveStep + 1);\r\n  const backStep = () => setActiveStep((prevActiveStep) => prevActiveStep - 1);\r\n\r\n  const next = (data) => {\r\n    setShippingData(data);\r\n    nextStep();\r\n  };\r\n  const timeout = () => {\r\n    return setTimeout(() => {\r\n      setIsFinished(true);\r\n    }, 10000);\r\n  };\r\n  const Form = () =>\r\n    activeStep == 0 ? (\r\n      <AddressForm checkoutToken={checkoutToken} next={next} />\r\n    ) : (\r\n      <PaymentFrom\r\n        shippingData={shippingData}\r\n        checkoutToken={checkoutToken}\r\n        nextStep={nextStep}\r\n        backStep={backStep}\r\n        handleCaptureCheckout={handleCaptureCheckout}\r\n        timeout={timeout}\r\n      />\r\n    );\r\n\r\n  let Confirmation = () => {\r\n    if (Order.customer) {\r\n      return (\r\n        <>\r\n          <div style={{ textDecoration: \"none\" }}>\r\n            <Typography variant=\"h5\">\r\n              Thank you for your purchase, {Order.customer.firstname}{\" \"}\r\n              {/* space between name*/}\r\n              {Order.customer.lastname}\r\n            </Typography>\r\n            <Typography variant=\"subtitle2\">\r\n              Order ref: {Order.customer_reference}\r\n            </Typography>\r\n          </div>\r\n          <br />\r\n          <Link\r\n            to=\"/E-Commerce/\"\r\n            color=\"secondary\"\r\n            style={{ textDecoration: \"none\" }}\r\n          >\r\n            <Button variant=\"outlined\" type=\"button\">\r\n              Back to Home\r\n            </Button>\r\n          </Link>\r\n        </>\r\n      );\r\n    } else if (isFinished) {\r\n      return (\r\n        <>\r\n          <div>\r\n            <Typography variant=\"h5\">Thank you for your purchase</Typography>\r\n          </div>\r\n          <br />\r\n          <Link\r\n            to=\"/E-Commerce/\"\r\n            style={{ textDecoration: \"none\" }}\r\n            color=\"secondary\"\r\n          >\r\n            <Button variant=\"outlined\" type=\"button\">\r\n              Back to Home\r\n            </Button>\r\n          </Link>\r\n        </>\r\n      );\r\n    } else {\r\n      return <Loading />;\r\n    }\r\n  };\r\n  if (error) {\r\n    Confirmation = () => (\r\n      <>\r\n        <Typography variant=\"h5\">Error: {error}</Typography>\r\n        <br />\r\n        <Link to=\"/E-Commerce/\" style={{ textDecoration: \"none\" }}>\r\n          <Button\r\n            variant=\"outlined\"\r\n            type=\"button\"\r\n            style={{ textDecoration: \"none\" }}\r\n          >\r\n            Back to home\r\n          </Button>\r\n        </Link>\r\n      </>\r\n    );\r\n  }\r\n  return (\r\n    <>\r\n      <Suspense fallback={<Loading />}>\r\n        <CssBaseline />\r\n        <div className={classes.toolbar} />\r\n        <main className={classes.layout}>\r\n          <Paper className={classes.paper}>\r\n            <Typography variant=\"h4\" align=\"center\">\r\n              Checkout\r\n            </Typography>\r\n            <Stepper activeStep={activeStep} className={classes.stepper}>\r\n              {steps.map((step) => {\r\n                return (\r\n                  <Step key={step}>\r\n                    <StepLabel>{step}</StepLabel>\r\n                  </Step>\r\n                );\r\n              })}\r\n            </Stepper>\r\n            {activeStep === steps.length ? (\r\n              <Confirmation />\r\n            ) : checkoutToken ? (\r\n              <Form />\r\n            ) : (\r\n              <Loading />\r\n            )}\r\n          </Paper>\r\n        </main>\r\n      </Suspense>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Checkout;\r\n"],"names":["useStyles","makeStyles","theme","AddressForm","lazy","__vitePreload","PaymentFrom","steps","Checkout","handleCaptureCheckout","classes","activeStep","setActiveStep","useState","checkoutToken","setCheckoutToken","shippingData","setShippingData","isFinished","setIsFinished","navigate","useNavigate","cartData","isLoading","error","Order","useSelector","state","Loading","useEffect","generateToken","token","commerce","nextStep","prevActiveStep","backStep","next","data","timeout","Form","jsx","Confirmation","jsxs","Fragment","Typography","Link","Button","Suspense","CssBaseline","Paper","Stepper","step","Step","StepLabel"],"mappings":"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"}